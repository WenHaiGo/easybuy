<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>易买网 - 首页</title>
<link type="text/css" rel="stylesheet" href="css/style.css" />

<script type="text/javascript" src="scripts/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="scripts/function.js"></script>
<script>
	$(function() {

		$
				.ajax({
					url : 'ProductServlet',
					type : 'post',
					data : {
						param : 'specialProduct',
					},
					dataType : 'json',
					success : function(data) {
						//从前端传来一个json里面是商品的所有信息。然后使用jquery读出来

						//这里data应该是一个list集合

						for (var i = 0; i < data.length; i++) {
							$("#special_price")
									.append(
											'<li>'
													+ '<dl>'
													+ '<dt><a href="ProductServlet?param=productView&EPId=1" target="_blank"><img src=' + data[i].EPFile + ' /></a></dt>'
													+ '<dd class="title"><a href="ProductServlet?param=productView&EPId=1" target="_blank">'
													+ data[i].EPName
													+ '</a></dd>'
													+ '<dd class="price">￥108.0</dd>'
													+ '</dl></li>')
						}

					}

				})

		//失去焦点的时候利用ajax判断用户名是否存在【注意】网络太慢应该会导致延迟
		//得到用户名

		//获取新闻题目列表信息
		$
				.ajax({
					url : 'ShowNewsServlet',
					type : 'post',
					data : {
						param : 'newsListPage',
					},
					dataType : 'json',
					success : function(data) {

						//加载新闻标题列表
						for (var i = 0; i < data.length; i++) {
							var href = 'ShowNewsServlet?param=newsDetailPage&newsTitle='
									+ data[i].ENTitle;
							$("#showNews").append(
									'<li><a href=' + href + '>'
											+ data[i].ENTitle + '</a></li>');
						}
					}
				})

		//加载分类上栏和下栏

		$.ajax({
			url : 'ProductServlet',
			type : 'post',
			data : {
				param : 'productCateg',
			},
			dataType : 'json',
			success : function(data) {

				//加载分类：
				//	<li><a href="product-list.html">影视</a></li>
				for (var i = 0; i < data.length; i++) {
					//加载顶部的菜单分类
					if (data[i].EPCIsOften == 1) {
						$("#topNav").append(
								'<li><a href=product-list.html>'
										+ data[i].EPCName + '</a></li>');
					}

					//加载左侧分类信息：
					//对于有有父类和子类的分类表其实就是根据pid来加载的   但是这个又不像是城市地区那样的，所以还是有点不一样
					//最本质的就是要知道什么时候分多少级，如果有一个功能不知道分多少级如何根据一个程序一劳永逸
					//data[i].EPCId==1表示图书音像分类，
					if (data[i].EPCId == 1) {

						$("#leftNav")
								.append('<dt>' + data[i].EPCName + '</dt>');
						//加载所有子类  注意优化代码减少不必要的循环
						for (var j = 0; j < data.length; j++) {
							if (data[j].EPCParentId == 1) {
								$("#leftNav").append(
										'<dd><a href = "product-list.html" >'
												+ data[j].EPCName
												+ ' </a> </dd>')
							}

						}

					}
					//data[i].EPCId==2表示百货分类
					if (data[i].EPCId == 2) {
						$("#leftNav")
								.append('<dt>' + data[i].EPCName + '</dt>');

						for (var j = 0; j < data.length; j++) {
							if (data[j].EPCParentId == 2) {
								$("#leftNav").append(
										'<dd><a href = "product-list.html" >'
												+ data[j].EPCName
												+ ' </a> </dd>')
							}

						}

					}
				}
			}
		})

	})
</script>
</head>

<body>
	<div id="header" class="wrap">
		<div id="logo">
			<a href="http://localhost:8080/yimai/index.html"><img
				src="images/logo.gif" /></a>
		</div>
		<div class="help">
			<a href="#" class="shopping">购物车</a> <a href="login.html">登录</a> <a
				href="register.html">注册</a> <a href="guestbook.html">留言</a>
		</div>
		<div class="navbar">
			<ul class="clearfix">
				<li class="current"><a href="#">首页</a></li>
				<li><a href="#">图书</a></li>
				<li><a href="#">百货</a></li>
				<li><a href="#">品牌</a></li>
				<li><a href="#">促销</a></li>
			</ul>
		</div>
	</div>
	<div id="childNav">
		<div class="wrap">
			<ul class="clearfix" id="topNav">
			</ul>
		</div>
	</div>
	<div id="main" class="wrap">
		<div class="lefter">
			<div class="box">
				<h2>商品分类</h2>
				<dl id="leftNav">
				</dl>
			</div>
			<div class="spacer"></div>
			<div class="last-view">
				<h2>最近浏览</h2>
				<dl class="clearfix">
					<dt>
						<img src="images/product/0_tiny.gif" />
					</dt>
					<dd>
						<a href="product-view.html">法国德菲丝松露精品巧克力500g/盒</a>
					</dd>
					<dt>
						<img src="images/product/0_tiny.gif" />
					</dt>
					<dd>
						<a href="product-view.html">法国德菲丝松露精品巧克力500g/盒</a>
					</dd>
				</dl>
			</div>
		</div>
		<div class="main">
			<div class="price-off">
				<h2>今日特价</h2>
				<ul class="product clearfix" id="special_price">
					<!--  ajax会动态的加载数据-->
				</ul>
			</div>
			<div class="side">
				<div class="news-list">
					<h4>最新公告</h4>
					<ul>
						<li><a href="news-view.html" target="_blank">抢钱啦</a></li>
						<li><a href="news-view.html" target="_blank">抢钱啦</a></li>
						<li><a href="news-view.html" target="_blank">抢钱啦</a></li>
						<li><a href="news-view.html" target="_blank">抢钱啦</a></li>
						<li><a href="news-view.html" target="_blank">抢钱啦</a></li>
						<li><a href="news-view.html" target="_blank">抢钱啦</a></li>
						<li><a href="news-view.html" target="_blank">抢钱啦</a></li>
					</ul>
				</div>
				<div class="spacer"></div>
				<div class="news-list">
					<h4>新闻动态</h4>
					<ul id="showNews">
						<!--全部使用jquery动态生成ajax的应用  -->

					</ul>
				</div>
			</div>
			<div class="spacer clear"></div>
			<div class="hot">
				<h2>热卖推荐</h2>
				<ul class="product clearfix">
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/1.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">法国德菲丝松露精品巧克力500g/盒</a>
							</dd>
							<dd class="price">￥108.0</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/2.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">乐扣普通型保鲜盒圣诞7件套</a>
							</dd>
							<dd class="price">￥69.90</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/3.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">欧珀莱均衡保湿四件套</a>
							</dd>
							<dd class="price">￥279.0</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/4.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">联想笔记本电脑 高速独立显存</a>
							</dd>
							<dd class="price">￥4199</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/5.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">法姿韩版显瘦彩边时尚牛仔铅笔裤</a>
							</dd>
							<dd class="price">￥49.00</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/6.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">Genius925纯银施华洛世奇水晶吊坠</a>
							</dd>
							<dd class="price">￥69.90</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/7.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">利仁2018M福满堂电饼铛
									好用实惠 </a>
							</dd>
							<dd class="price">￥268.0</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/8.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">达派高档拉杆箱20寸 经典款式</a>
							</dd>
							<dd class="price">￥198.0</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/9.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">爱国者MP4 全屏触摸多格式播放
									4G </a>
							</dd>
							<dd class="price">￥289.0</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/10.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">多美滋金装金盾3阶段幼儿配方奶粉</a>
							</dd>
							<dd class="price">￥186.0</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/1.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">法国德菲丝松露精品巧克力500g/盒</a>
							</dd>
							<dd class="price">￥108.0</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt>
								<a href="product-view.html" target="_blank"><img
									src="images/product/2.jpg" /></a>
							</dt>
							<dd class="title">
								<a href="product-view.html" target="_blank">乐扣普通型保鲜盒圣诞7件套</a>
							</dd>
							<dd class="price">￥69.90</dd>
						</dl>
					</li>
				</ul>
			</div>
		</div>
		<div class="clear"></div>
	</div>
	<div id="footer">Copyright &copy; 2010 北大青鸟 All Rights Reserved.
		京ICP证1000001号</div>
</body>

</html>